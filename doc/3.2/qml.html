<!-- HTML header for doxygen 1.8.5-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.7"/>
<title>Communi: QML compatibility</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><a href="http://communi.github.com"><img alt="Logo" src="communi.png"/></a></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">Communi
   &#160;<span id="projectnumber">3.2.0</span>
   </div>
   <div id="projectbrief">A cross-platform IRC framework written with Qt</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.7 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Properties</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">QML compatibility </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Communi strives for full QML support. The property-based APIs have been designed QML compatibility in mind. Almost all the types can be registered to QML and used as is.</p>
<p>A ready-made QML plugin is also provided for convenience. The plugin does QML type registration and is made available via the following import:</p>
<div class="fragment"><div class="line"><span class="keyword">import</span> Communi 3.0</div>
</div><!-- fragment --><h1><a class="anchor" id="qml-type-registration"></a>
Type registration</h1>
<p>The following snippet illustrates how the Communi QML plugin does the type registration. The same can be done manually in application code to avoid the need of deploying the Communi QML plugin.</p>
<div class="fragment"><div class="line">        <span class="comment">// IrcCore</span></div>
<div class="line">        <a class="code" href="namespace_irc.html#afa05f22dcc661ce3bec121035a6c6427">Irc::registerMetaTypes</a>();</div>
<div class="line">        qmlRegisterType&lt;Irc&gt;(uri, 3, 0, <span class="stringliteral">&quot;Irc&quot;</span>);</div>
<div class="line">        qmlRegisterType&lt;Irc&gt;(uri, 3, 2, <span class="stringliteral">&quot;Irc&quot;</span>);</div>
<div class="line">        qmlRegisterType&lt;IrcCommand&gt;(uri, 3, 0, <span class="stringliteral">&quot;IrcCommand&quot;</span>);</div>
<div class="line">        qmlRegisterType&lt;IrcConnection&gt;(uri, 3, 0, <span class="stringliteral">&quot;IrcConnection&quot;</span>);</div>
<div class="line">        qmlRegisterUncreatableType&lt;IrcMessage&gt;(uri, 3, 0, <span class="stringliteral">&quot;IrcMessage&quot;</span>, <span class="stringliteral">&quot;Cannot create an instance of IrcMessage. Use IrcConnection::messageReceived() signal instead.&quot;</span>);</div>
<div class="line">        qmlRegisterUncreatableType&lt;IrcNetwork&gt;(uri, 3, 0, <span class="stringliteral">&quot;IrcNetwork&quot;</span>, <span class="stringliteral">&quot;Cannot create an instance of IrcNetwork. Use IrcConnection::network property instead.&quot;</span>);</div>
<div class="line">        qmlRegisterType&lt;IrcQmlFilter&gt;(uri, 3, 0, <span class="stringliteral">&quot;IrcMessageFilter&quot;</span>);</div>
<div class="line">        qmlRegisterType&lt;IrcQmlFilter&gt;(uri, 3, 0, <span class="stringliteral">&quot;IrcCommandFilter&quot;</span>);</div>
<div class="line">        qmlRegisterType&lt;IrcQmlFilter&gt;(uri, 3, 0, <span class="stringliteral">&quot;IrcFilter&quot;</span>);</div>
<div class="line"></div>
<div class="line">        <span class="comment">// IrcModel</span></div>
<div class="line">        qmlRegisterType&lt;IrcBuffer&gt;(uri, 3, 0, <span class="stringliteral">&quot;IrcBuffer&quot;</span>);</div>
<div class="line">        qmlRegisterType&lt;IrcBufferModel&gt;(uri, 3, 0, <span class="stringliteral">&quot;IrcBufferModel&quot;</span>);</div>
<div class="line">        qmlRegisterType&lt;IrcChannel&gt;(uri, 3, 0, <span class="stringliteral">&quot;IrcChannel&quot;</span>);</div>
<div class="line">        qmlRegisterType&lt;IrcUser&gt;(uri, 3, 0, <span class="stringliteral">&quot;IrcUser&quot;</span>);</div>
<div class="line">        qmlRegisterType&lt;IrcUserModel&gt;(uri, 3, 0, <span class="stringliteral">&quot;IrcUserModel&quot;</span>);</div>
<div class="line"></div>
<div class="line">        <span class="comment">// IrcUtil</span></div>
<div class="line">        qmlRegisterType&lt;IrcCommandParser&gt;(uri, 3, 0, <span class="stringliteral">&quot;IrcCommandParser&quot;</span>);</div>
<div class="line">        qmlRegisterType&lt;IrcLagTimer&gt;(uri, 3, 0, <span class="stringliteral">&quot;IrcLagTimer&quot;</span>);</div>
<div class="line">        qmlRegisterType&lt;IrcTextFormat&gt;(uri, 3, 0, <span class="stringliteral">&quot;IrcTextFormat&quot;</span>);</div>
<div class="line">        qmlRegisterUncreatableType&lt;IrcPalette&gt;(uri, 3, 0, <span class="stringliteral">&quot;IrcPalette&quot;</span>, <span class="stringliteral">&quot;Cannot create an instance of IrcPalette. Use IrcTextFormat::palette property instead.&quot;</span>);</div>
<div class="line">        qmlRegisterType&lt;IrcCompleter&gt;(uri, 3, 1, <span class="stringliteral">&quot;IrcCompleter&quot;</span>);</div>
</div><!-- fragment --> <h1><a class="anchor" id="qml-connecting-to-irc"></a>
Connecting to IRC</h1>
<p>In order to connect to IRC in QML, declare an <a class="el" href="class_irc_connection.html" title="Provides means to establish a connection to an IRC server. ">IrcConnection</a> instance, set the desired properties, and call <a class="el" href="class_irc_connection.html#aac183ddc53ffa66efdb6a4c45c273a8f">connection.open()</a>.</p>
<div class="fragment"><div class="line"><a class="code" href="class_irc_connection.html">IrcConnection</a> {</div>
<div class="line">    <span class="keywordtype">id</span>: freenode</div>
<div class="line">    host: <span class="stringliteral">&quot;irc.freenode.net&quot;</span></div>
<div class="line">    userName: <span class="stringliteral">&quot;communi&quot;</span></div>
<div class="line">    nickName: <span class="stringliteral">&quot;Communi&quot;</span> + Math.round(Math.random() * 9999)</div>
<div class="line">    realName: <span class="stringliteral">&quot;Communi QML example&quot;</span></div>
<div class="line">}</div>
</div><!-- fragment --><h1><a class="anchor" id="qml-sending-commands"></a>
Sending commands</h1>
<p>Even though the IrcCommand::createXxx() methods are static, QML does not provide a way to call them without an <a class="el" href="class_irc_command.html" title="Provides the most common commands. ">IrcCommand</a> instance. Thus, in order to create and send commands, declare an instance of <a class="el" href="class_irc_command.html" title="Provides the most common commands. ">IrcCommand</a>, call any createXxx() method to create a command, and finally send it via IrcCommand::sendCommand().</p>
<div class="fragment"><div class="line"><a class="code" href="class_irc_command.html">IrcCommand</a> { <span class="keywordtype">id</span>: command }</div>
<div class="line"></div>
<div class="line"><a class="code" href="class_irc_connection.html">IrcConnection</a> {</div>
<div class="line">    onConnected: {</div>
<div class="line">        var cmd = command.<a class="code" href="class_irc_command.html#a3fd566e0f47e6c698a155e0e0458fa2b">createJoin</a>(channel)</div>
<div class="line">        sendCommand(cmd)</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --><h1><a class="anchor" id="qml-channels-and-queries"></a>
Channels and queries</h1>
<p>In order to keep track of channels and queries, declare an instance of <a class="el" href="class_irc_buffer_model.html" title="Keeps track of buffers. ">IrcBufferModel</a>. Notice that it can be used directly as a data model for QML types such as ListView and Repeater.</p>
<div class="fragment"><div class="line"><a class="code" href="class_irc_buffer_model.html">IrcBufferModel</a> {</div>
<div class="line">    <span class="keywordtype">id</span>: bufferModel</div>
<div class="line">    connection: freenode</div>
<div class="line">}</div>
</div><!-- fragment --><p><a class="el" href="class_irc_buffer_model.html" title="Keeps track of buffers. ">IrcBufferModel</a> creates channel and query buffers automatically when the client joins channels and receives private messages, respectively.</p>
<p>A typical IRC client has a special server buffer for messages that are not targeted to any specific channel or query. This can be easily achieved by declaring an instance of <a class="el" href="class_irc_buffer.html" title="Keeps track of buffer status. ">IrcBuffer</a> and forwarding the messages ignored by <a class="el" href="class_irc_buffer_model.html" title="Keeps track of buffers. ">IrcBufferModel</a> to it.</p>
<div class="fragment"><div class="line"><a class="code" href="class_irc_buffer.html">IrcBuffer</a> {</div>
<div class="line">    <span class="keywordtype">id</span>: serverBuffer</div>
<div class="line">    name: freenode.displayName</div>
<div class="line">    Component.onCompleted: bufferModel.add(serverBuffer)</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><a class="code" href="class_irc_buffer_model.html">IrcBufferModel</a> {</div>
<div class="line">    <span class="keywordtype">id</span>: bufferModel</div>
<div class="line">    connection: freenode</div>
<div class="line">    onMessageIgnored: serverBuffer.<a class="code" href="class_irc_buffer_model.html#affd6eb471fe44550013d99250eafe5c7">receiveMessage</a>(message)</div>
<div class="line">}</div>
</div><!-- fragment --><h1><a class="anchor" id="qml-channel-users"></a>
Channel users</h1>
<p>In order to keep track of channel users, create an instance of <a class="el" href="class_irc_user_model.html" title="Keeps track of channel users. ">IrcUserModel</a>. It can be also used directly as a data model for QML types such as ListView and Repeater.</p>
<div class="fragment"><div class="line"><a class="code" href="class_irc_user_model.html">IrcUserModel</a> {</div>
<div class="line">    <span class="keywordtype">id</span>: userModel</div>
<div class="line">    channel: currentBuffer.toChannel()</div>
<div class="line">}</div>
</div><!-- fragment --><h1><a class="anchor" id="qml-parsing-user-commands"></a>
Parsing user commands</h1>
<p><a class="el" href="class_irc_command_parser.html" title="Parses commands from user input. ">IrcCommandParser</a> helps with parsing commands from user input. In order to take it in use, declare an instance of <a class="el" href="class_irc_command_parser.html" title="Parses commands from user input. ">IrcCommandParser</a> and introduce the desired commands.</p>
<p>Notice that commands are often context sensitive. While some command may accept an optional parameter that is filled up with the current target (channel/query) name when absent, another command may always inject the current target name as a certain parameter. Therefore <a class="el" href="class_irc_command_parser.html" title="Parses commands from user input. ">IrcCommandParser</a> must be kept up-to-date with the current target and the list of channels.</p>
<div class="fragment"><div class="line">IrcCommandParser {</div>
<div class="line">    <span class="keywordtype">id</span>: parser</div>
<div class="line">    triggers: [<span class="stringliteral">&quot;/&quot;</span>]</div>
<div class="line">    target: currentBuffer.title</div>
<div class="line">    channels: bufferModel.channels</div>
<div class="line">    Component.onCompleted: {</div>
<div class="line">        parser.addCommand(<a class="code" href="class_irc_command.html">IrcCommand</a>.<a class="code" href="class_irc_command.html#aa372efb107a86cec49b7587210132325a9633cce712489c7906872fbfb3969493">Join</a>, <span class="stringliteral">&quot;JOIN &lt;#channel&gt; (&lt;key&gt;)&quot;</span>);</div>
<div class="line">        parser.addCommand(<a class="code" href="class_irc_command.html">IrcCommand</a>.<a class="code" href="class_irc_command.html#aa372efb107a86cec49b7587210132325a2b6e8db583625d114ae748598f769432">Part</a>, <span class="stringliteral">&quot;PART (&lt;#channel&gt;) (&lt;message...&gt;)&quot;</span>);</div>
<div class="line">        parser.addCommand(<a class="code" href="class_irc_command.html">IrcCommand</a>.<a class="code" href="class_irc_command.html#aa372efb107a86cec49b7587210132325a2685e9ba777e4f0ae6cf3e34ee817416">Kick</a>, <span class="stringliteral">&quot;KICK (&lt;#channel&gt;) &lt;nick&gt; (&lt;reason...&gt;)&quot;</span>);</div>
<div class="line">        parser.addCommand(<a class="code" href="class_irc_command.html">IrcCommand</a>.<a class="code" href="class_irc_command.html#aa372efb107a86cec49b7587210132325ab3140c97601256d0ce633f2fda34116d">CtcpAction</a>, <span class="stringliteral">&quot;ME [target] &lt;message...&gt;&quot;</span>);</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --> </div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Tue Aug 19 2014 18:34:26 for Communi by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.7
</small></address>
</body>
</html>
