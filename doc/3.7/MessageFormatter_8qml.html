<!-- HTML header for doxygen 1.8.5-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<title>Communi: examples/quick/qml/MessageFormatter.qml File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><a href="https://communi.github.io"><img alt="Logo" src="communi.png"/></a></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">Communi
   &#160;<span id="projectnumber">3.7.0</span>
   </div>
   <div id="projectbrief">A cross-platform IRC framework written with Qt</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_d28a4824dc47e487b107a5db32ef43c4.html">examples</a></li><li class="navelem"><a class="el" href="dir_dd85b1dfeadb33db0bb60a6220a98df2.html">quick</a></li><li class="navelem"><a class="el" href="dir_8496489fdfc350c5a85214a4c6efe7f2.html">qml</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">MessageFormatter.qml File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><a class="el" href="quick.html">Qt Quick example</a>  
<a href="#details">More...</a></p>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><div class="fragment"><div class="line">/*</div>
<div class="line"> * Copyright (C) 2008-2020 The Communi Project</div>
<div class="line"> *</div>
<div class="line"> * This example is free, and not covered by the BSD license. There is no</div>
<div class="line"> * restriction applied to their modification, redistribution, using and so on.</div>
<div class="line"> * You can study them, modify them, use them in your own program - either</div>
<div class="line"> * completely or partially.</div>
<div class="line"> */</div>
<div class="line"> </div>
<div class="line">import QtQuick 2.1</div>
<div class="line">import Communi 3.0</div>
<div class="line"> </div>
<div class="line">QtObject {</div>
<div class="line">    id: root</div>
<div class="line"> </div>
<div class="line">    property IrcTextFormat textFormat: IrcTextFormat {</div>
<div class="line">        id: textFormat</div>
<div class="line"> </div>
<div class="line">        palette.gray: &quot;#606060&quot;</div>
<div class="line">        palette.lightGray: &quot;#808080&quot;</div>
<div class="line"> </div>
<div class="line">        // http://ethanschoonover.com/solarized</div>
<div class="line">        palette.blue: &quot;#268bd2&quot;</div>
<div class="line">        palette.green: &quot;#859900&quot;</div>
<div class="line">        palette.red: &quot;#dc322f&quot;</div>
<div class="line">        palette.brown: &quot;#cb4b16&quot;</div>
<div class="line">        palette.purple: &quot;#6c71c4&quot;</div>
<div class="line">        palette.orange: &quot;#cb4b16&quot;</div>
<div class="line">        palette.yellow: &quot;#b58900&quot;</div>
<div class="line">        palette.lightGreen: &quot;#859900&quot;</div>
<div class="line">        palette.cyan: &quot;#2aa198&quot;</div>
<div class="line">        palette.lightCyan: &quot;#2aa198&quot;</div>
<div class="line">        palette.lightBlue: &quot;#268bd2&quot;</div>
<div class="line">        palette.pink: &quot;#6c71c4&quot;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    function formatMessage(message) {</div>
<div class="line">        var formatted</div>
<div class="line">        switch (message.type) {</div>
<div class="line">            case IrcMessage.Invite:  formatted = formatInviteMessage(message); break</div>
<div class="line">            case IrcMessage.Join:    formatted = formatJoinMessage(message); break</div>
<div class="line">            case IrcMessage.Kick:    formatted = formatKickMessage(message); break</div>
<div class="line">            case IrcMessage.Mode:    formatted = formatModeMessage(message); break</div>
<div class="line">            case IrcMessage.Names:   formatted = formatNamesMessage(message); break</div>
<div class="line">            case IrcMessage.Nick:    formatted = formatNickMessage(message); break</div>
<div class="line">            case IrcMessage.Notice:  formatted = formatNoticeMessage(message); break</div>
<div class="line">            case IrcMessage.Numeric: formatted = formatNumericMessage(message); break</div>
<div class="line">            case IrcMessage.Part:    formatted = formatPartMessage(message); break</div>
<div class="line">            case IrcMessage.Private: formatted = formatPrivateMessage(message); break</div>
<div class="line">            case IrcMessage.Quit:    formatted = formatQuitMessage(message); break</div>
<div class="line">            case IrcMessage.Topic:   formatted = formatTopicMessage(message); break</div>
<div class="line">        }</div>
<div class="line">        return formatText(formatted, message.timeStamp)</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    function formatText(text, timeStamp) {</div>
<div class="line">        if (text) {</div>
<div class="line">            switch (text[0]) {</div>
<div class="line">                case &#39;!&#39;: text = qsTr(&quot;&lt;font color=&#39;gray&#39;&gt;%1&lt;/font&gt;&quot;).arg(text); break;</div>
<div class="line">                case &#39;[&#39;: text = qsTr(&quot;&lt;font color=&#39;brown&#39;&gt;%1&lt;/font&gt;&quot;).arg(text); break;</div>
<div class="line">                case &#39;*&#39;: text = qsTr(&quot;&lt;font color=&#39;darkmagenta&#39;&gt;%1&lt;/font&gt;&quot;).arg(text); break;</div>
<div class="line">                case &#39;?&#39;: text = qsTr(&quot;&lt;font color=&#39;brown&#39;&gt;%1&lt;/font&gt;&quot;).arg(text); break;</div>
<div class="line">                default: break;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            return qsTr(&quot;&lt;font color=&#39;gray&#39;&gt;[%1]&lt;/font&gt; %2&quot;).arg(Qt.formatTime(timeStamp, &quot;hh:mm:ss&quot;)).arg(text)</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    function formatInviteMessage(message) {</div>
<div class="line">        var sender = formatName(message.nick)</div>
<div class="line">        return qsTr(&quot;! %1 invited to %3&quot;).arg(sender).arg(message.channel)</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    function formatJoinMessage(message) {</div>
<div class="line">        var sender = formatName(message.nick)</div>
<div class="line">        return qsTr(&quot;! %1 joined %2&quot;).arg(sender).arg(message.channel)</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    function formatKickMessage(message) {</div>
<div class="line">        var sender = formatName(message.nick)</div>
<div class="line">        var user = formatName(message.user)</div>
<div class="line">        if (message.reason.length)</div>
<div class="line">            return qsTr(&quot;! %1 kicked %2 (%3)&quot;).arg(sender).arg(user).arg(message.reason)</div>
<div class="line">        return qsTr(&quot;! %1 kicked %2&quot;).arg(sender).arg(user)</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    function formatModeMessage(message) {</div>
<div class="line">        var sender = formatName(message.nick)</div>
<div class="line">        if (message.reply)</div>
<div class="line">            return qsTr(&quot;! %1 mode is %2 %3&quot;).arg(message.target).arg(message.mode).arg(message.argument)</div>
<div class="line">        return qsTr(&quot;! %1 sets mode %2 %3&quot;).arg(sender).arg(message.mode).arg(message.argument)</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    function formatNamesMessage(message) {</div>
<div class="line">        return qsTr(&quot;! %1 has %2 users&quot;).arg(message.channel).arg(message.names.length)</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    function formatNickMessage(message) {</div>
<div class="line">        var sender = formatName(message.nick)</div>
<div class="line">        var nick = formatName(message.newNick)</div>
<div class="line">        return qsTr(&quot;! %1 changed nick to %2&quot;).arg(sender).arg(nick)</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    function formatNoticeMessage(message) {</div>
<div class="line">        var sender = formatName(message.nick)</div>
<div class="line">        var content = formatHtml(message.content)</div>
<div class="line">        return qsTr(&quot;[%1] %2&quot;).arg(sender).arg(content)</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    function formatNumericMessage(message) {</div>
<div class="line">        switch (message.code) {</div>
<div class="line">        case Irc.RPL_TOPIC:</div>
<div class="line">        case Irc.RPL_TOPICWHOTIME:</div>
<div class="line">        case Irc.RPL_CHANNEL_URL:</div>
<div class="line">        case Irc.RPL_NAMREPLY:</div>
<div class="line">        case Irc.RPL_ENDOFNAMES:</div>
<div class="line">            return // ignore</div>
<div class="line">        default:</div>
<div class="line">            return qsTr(&quot;[%1] %2&quot;).arg(message.code).arg(message.parameters.slice(1).join(&quot; &quot;))</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    function formatPartMessage(message) {</div>
<div class="line">        var sender = formatName(message.nick)</div>
<div class="line">        if (message.reason.length)</div>
<div class="line">            return qsTr(&quot;! %1 parted %2 (%3)&quot;).arg(sender).arg(message.channel).arg(formatHtml(message.reason))</div>
<div class="line">        return qsTr(&quot;! %1 parted %2&quot;).arg(sender).arg(message.channel)</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    function formatPrivateMessage(message) {</div>
<div class="line">        var sender = formatName(message.nick)</div>
<div class="line">        var content = formatHtml(message.content)</div>
<div class="line">        if (message.action)</div>
<div class="line">            return qsTr(&quot;* %1 %2&quot;).arg(sender).arg(content)</div>
<div class="line">        if (message.request)</div>
<div class="line">            return qsTr(&quot;! %1 requested %2&quot;).arg(sender).arg(content.split(&quot; &quot;)[0].toLowerCase())</div>
<div class="line">        return qsTr(&quot;&amp;lt;%1&amp;gt; %2&quot;).arg(sender).arg(content)</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    function formatQuitMessage(message) {</div>
<div class="line">        var sender = formatName(message.nick)</div>
<div class="line">        if (message.reason.length)</div>
<div class="line">            return qsTr(&quot;! %1 has quit (%2)&quot;).arg(sender).arg(formatHtml(message.reason))</div>
<div class="line">        return qsTr(&quot;! %1 has quit&quot;).arg(sender)</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    function formatTopicMessage(message) {</div>
<div class="line">        var sender = formatName(message.nick)</div>
<div class="line">        var topic = formatHtml(message.topic)</div>
<div class="line">        var channel = message.channel</div>
<div class="line">        if (message.reply)</div>
<div class="line">            return qsTr(&quot;! %1 topic is \&quot;%2\&quot;&quot;).arg(channel).arg(topic)</div>
<div class="line">        return qsTr(&quot;! %1 sets topic \&quot;%2\&quot; on %3&quot;).arg(sender).arg(topic).arg(channel)</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    function formatHtml(message) {</div>
<div class="line">        return textFormat.toHtml(message)</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    function formatName(name) {</div>
<div class="line">        var color = hslToRgb((hashCode(name) % 359)/359, 0.5, 0.25)</div>
<div class="line">        var r = (&quot;0&quot; + Math.round(Math.abs(color[0])).toString(16)).substr(-2)</div>
<div class="line">        var g = (&quot;0&quot; + Math.round(Math.abs(color[1])).toString(16)).substr(-2)</div>
<div class="line">        var b = (&quot;0&quot; + Math.round(Math.abs(color[2])).toString(16)).substr(-2)</div>
<div class="line">        return qsTr(&quot;&lt;b&gt;&lt;font color=&#39;#%1&#39;&gt;%2&lt;/font&gt;&lt;/b&gt;&quot;).arg(r+g+b).arg(name);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    function hashCode(str) {</div>
<div class="line">        var hash = 0;</div>
<div class="line">        if (str.length == 0) return hash;</div>
<div class="line">        for (var i = 0; i &lt; str.length; i++) {</div>
<div class="line">            var chr = str.charCodeAt(i);</div>
<div class="line">            hash = ((hash&lt;&lt;5)-hash)+chr;</div>
<div class="line">            hash = hash &amp; hash; // Convert to 32bit integer</div>
<div class="line">        }</div>
<div class="line">        return hash;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    /**</div>
<div class="line">     * Converts an HSL color value to RGB. Conversion formula</div>
<div class="line">     * adapted from http://en.wikipedia.org/wiki/HSL_color_space.</div>
<div class="line">     * Assumes h, s, and l are contained in the set [0, 1] and</div>
<div class="line">     * returns r, g, and b in the set [0, 255].</div>
<div class="line">     *</div>
<div class="line">     * @param   Number  h       The hue</div>
<div class="line">     * @param   Number  s       The saturation</div>
<div class="line">     * @param   Number  l       The lightness</div>
<div class="line">     * @return  Array           The RGB representation</div>
<div class="line">     */</div>
<div class="line">    function hslToRgb(h, s, l){</div>
<div class="line">        var r, g, b;</div>
<div class="line"> </div>
<div class="line">        function hue2rgb(p, q, t){</div>
<div class="line">            if(t &lt; 0) t += 1;</div>
<div class="line">            if(t &gt; 1) t -= 1;</div>
<div class="line">            if(t &lt; 1/6) return p + (q - p) * 6 * t;</div>
<div class="line">            if(t &lt; 1/2) return q;</div>
<div class="line">            if(t &lt; 2/3) return p + (q - p) * (2/3 - t) * 6;</div>
<div class="line">            return p;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        if(s == 0){</div>
<div class="line">            r = g = b = l; // achromatic</div>
<div class="line">        }else{</div>
<div class="line">            var q = l &lt; 0.5 ? l * (1 + s) : l + s - l * s;</div>
<div class="line">            var p = 2 * l - q;</div>
<div class="line">            r = hue2rgb(p, q, h + 1/3);</div>
<div class="line">            g = hue2rgb(p, q, h);</div>
<div class="line">            b = hue2rgb(p, q, h - 1/3);</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        return [r * 255, g * 255, b * 255];</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --> </div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sat Dec 18 2021 23:21:00 for Communi by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
